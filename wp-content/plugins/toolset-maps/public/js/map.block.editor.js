!function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s="./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/index.js")}({"./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/edit.js":function(e,t,o){"use strict";(function(e){o.d(t,"a",(function(){return O}));var r=o("@wordpress/element"),n=o("@wordpress/i18n"),a=o("./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/inspector/inspector.js"),i=o("./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/render/server-side-render-map.js"),s=o("./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/render/client-side-render-map.js"),c=o("@wordpress/hooks"),l=o("@wordpress/compose"),u=o("@wordpress/block-editor"),p=o("@wordpress/data"),d=o("ToolsetDynamicSources"),m=o("@wordpress/components"),f=o("lodash");function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t,o,r,n,a,i){try{var s=e[a](i),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(r,n)}function b(e){return function(){var t=this,o=arguments;return new Promise((function(r,n){var a=e.apply(t,o);function i(e){h(a,r,n,i,s,"next",e)}function s(e){h(a,r,n,i,s,"throw",e)}i(void 0)}))}}function v(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,r=C(e);if(t){var n=C(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return w(this,o)}}function w(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?S(e):t}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var O="markerDynamicAddress",M=window.toolset_map_block_strings,j=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(h,t);var o,r,l,g=k(h);function h(t,o){var r;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),_(S(r=g.call(this,t,o)),"getNextMapId",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return M.mapCounter++,e&&r.updateCounters(),"map-"+M.mapCounter})),_(S(r),"getNextMarkerId",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return M.markerCounter++,e&&r.updateCounters(),"marker-"+M.markerCounter})),_(S(r),"updateCounters",(function(){e.jQuery.ajax({type:"POST",url:window.ajaxurl,data:{action:"wpv_toolset_maps_addon_update_counters",map_counter:M.mapCounter,marker_counter:M.markerCounter,wpnonce:window.wpv_addon_maps_dialogs_local.nonce},dataType:"json"})})),_(S(r),"updateBlockContentFromCache",b(regeneratorRuntime.mark((function e(){var t,o,n,a,i,s,c,l,u,p,m,f,g,h,b,v,y,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.props,o=t.attributes,n=t.setAttributes,a=t.post,i=t.previewPost,s=o.markerSource,c=o.markerDynamicAddress,l=o.markerAddress,u=JSON.parse(s),p=JSON.parse(c),m=JSON.parse(l),f=i||a,-1!==(g=u.indexOf("dynamic"))){e.next=9;break}return e.abrupt("return");case 9:return h=p[g],b=h.postProvider,v=h.source,y=h.field?h.field:null,e.next=15,Object(d.fetchDynamicContent)(b,f,v,y);case 15:(k=e.sent)&&k.sourceContent!==m[g]&&(m[g]=k.sourceContent,n({markerAddress:JSON.stringify(m)}));case 17:case"end":return e.stop()}}),e)})))),_(S(r),"isParentBlockOfType",(function(e,t){var o=Object(p.select)("core/block-editor"),r=o.getBlock,n=o.getBlockRootClientId,a=e;do{if(""!==(a=n(a))){var i=r(a);if(!i)return!1;if(t.includes(i.name))return!0}}while(""!==a);return!1})),_(S(r),"handleServerRenderComplete",(function(){r.setState((function(e){return{useServerRender:!1,renderCounter:e.renderCounter+1}}))})),_(S(r),"triggerServerRender",(function(){r.setState({useServerRender:!0})})),!t.attributes.mapId){t.attributes.mapId=r.getNextMapId(!1);var n=JSON.parse(t.attributes.markerId);n[0]=r.getNextMarkerId(!1),t.attributes.markerId=JSON.stringify(n),r.updateCounters()}return r.state={useServerRender:!1,renderCounter:0},r}return o=h,(r=[{key:"componentDidMount",value:function(){Object(c.addAction)("tb.caching.updated","toolset-blocks",this.updateBlockContentFromCache)}},{key:"render",value:function(){var e=this,t=this.state,o=t.useServerRender,r=t.renderCounter,c=this.props,l=c.attributes;if(this.isParentBlockOfType(c.clientId,["toolset-views/view-template-block","toolset-views/view-editor"]))return React.createElement(m.Notice,{status:"error",isDismissible:!1},Object(n.__)("Map block cannot be inside the View block. If you want map markers to come from a View, place the Map block outside the View and in the Marker section, select View block for the Source for the marker option.","toolset-maps"));var p=["markerId","markerAddress","markerSource","currentVisitorLocationRenderTime","markerLat","markerLon","markerTitle","popupContent","markerUseMapIcon","markerIcon","markerIconUseDifferentForHover","markerIconHover","markerDynamicAddress","markerView","markerPreviewView","markerViewField"],d=function(e){var t=Object(f.clone)(e);return p.forEach((function(e){t[e]=JSON.parse(t[e])})),t},g=function(){return Object(f.flatten)(Object(f.map)(e.props.blocks,(function(e){return function e(t){return t.innerBlocks.length?Object(f.flatten)(Object(f.concat)(Object(f.map)(t.innerBlocks,(function(t){return e(t)})),t)):t}(e)})))},h=function(){return Object(f.concat)(Object(f.filter)(e.props.blocks,{name:"toolset/view"}),Object(f.filter)(g(),{name:"toolset-views/view-editor"}),Object(f.filter)(g(),{name:"toolset-views/wpa-editor"}))},b=function(e,t,o){var r=JSON.parse(c.attributes[e]),n={};r[o]="string"==typeof t?t.replace(/"/g,"'"):t,n[e]=JSON.stringify(r),c.setAttributes(n)},v=function(e,t){var o=JSON.parse(c.attributes[e]),r={};o[t]=!o[t],r[e]=JSON.stringify(o),c.setAttributes(r)},y=function(e){var t={};p.forEach((function(o){t[o]=JSON.stringify(e[o])})),c.setAttributes(t)};return[!(!c.focus&&!c.isSelected||!M.apiKey&&"osm"!==M.api)&&React.createElement(a.a,{key:"toolset-gutenberg-map-block-inspector",clientId:c.clientId,attributes:d(c.attributes),onChangeMapId:function(t){e.setState({useServerRender:!0}),c.setAttributes({mapId:t})},onChangeMapWidth:function(e){return c.setAttributes({mapWidth:e})},onChangeMapHeight:function(e){return c.setAttributes({mapHeight:e})},onChangeMapZoomAutomatic:function(){c.setAttributes({mapZoomAutomatic:!c.attributes.mapZoomAutomatic})},onChangeMapZoomLevelForMultipleMarkers:function(e){c.setAttributes({mapZoomLevelForMultipleMarkers:e})},onChangeMapZoomLevelForSingleMarker:function(e){c.setAttributes({mapZoomLevelForSingleMarker:e})},onChangeMapCenterLat:function(e){return c.setAttributes({mapCenterLat:e})},onChangeMapCenterLon:function(e){return c.setAttributes({mapCenterLon:e})},onChangeMapForceCenterSettingForSingleMarker:function(){return c.setAttributes({mapForceCenterSettingForSingleMarker:!c.attributes.mapForceCenterSettingForSingleMarker})},onChangeMapMarkerClustering:function(){"google"!==M.api||l.mapMarkerClustering||void 0!==window.MarkerClusterer?c.setAttributes({mapMarkerClustering:!l.mapMarkerClustering}):(window.views_addon_maps_clusterer_i10n={cluster_default_imagePath:M.assetsURL+"/resources/images/clusterer/m"},jQuery.getScript(M.assetsURL+"/resources/js/markerclusterer.js").done((function(){c.setAttributes({mapMarkerClustering:!0})})))},onChangeMapMarkerClusteringMinimalNumber:function(e){c.setAttributes({mapMarkerClusteringMinimalNumber:e})},onChangeMapMarkerClusteringMinimalDistance:function(e){c.setAttributes({mapMarkerClusteringMinimalDistance:e})},onChangeMapMarkerClusteringMaximalZoomLevel:function(e){c.setAttributes({mapMarkerClusteringMaximalZoomLevel:e})},onChangeMapMarkerClusteringClickZoom:function(){c.setAttributes({mapMarkerClusteringClickZoom:!c.attributes.mapMarkerClusteringClickZoom})},onChangeMapMarkerSpiderfying:function(){e.setState({useServerRender:!0}),"google"!==M.api||l.mapMarkerSpiderfying||void 0!==window.OverlappingMarkerSpiderfier?c.setAttributes({mapMarkerSpiderfying:!l.mapMarkerSpiderfying}):jQuery.getScript(M.assetsURL+"/resources/js/oms.min.js").done((function(){c.setAttributes({mapMarkerSpiderfying:!0})}))},onChangeMapDraggable:function(){return c.setAttributes({mapDraggable:!c.attributes.mapDraggable})},onChangeMapScrollable:function(){return c.setAttributes({mapScrollable:!c.attributes.mapScrollable})},onChangeMapDoubleClickZoom:function(){c.setAttributes({mapDoubleClickZoom:!c.attributes.mapDoubleClickZoom})},onChangeMapOsmTileLayer:function(e){return c.setAttributes({osmTileLayer:e})},onChangeMapType:function(e){return c.setAttributes({mapType:e})},onChangeMapTypeControl:function(){c.setAttributes({mapTypeControl:!c.attributes.mapTypeControl})},onChangeMapZoomControls:function(){c.setAttributes({mapZoomControls:!c.attributes.mapZoomControls})},onChangeMapStreetViewControl:function(){c.setAttributes({mapStreetViewControl:!c.attributes.mapStreetViewControl})},onChangeMapFullScreenControl:function(){c.setAttributes({mapFullScreenControl:!l.mapFullScreenControl})},onChangeMapBackgroundColor:function(e){return c.setAttributes({mapBackgroundColor:e})},onChangeMapLoadingText:function(e){return c.setAttributes({mapLoadingText:e})},onChangeMapMarkerIcon:function(e){return c.setAttributes({mapMarkerIcon:e})},onChangeMapMarkerIconUseDifferentForHover:function(){return c.setAttributes({mapMarkerIconUseDifferentForHover:!c.attributes.mapMarkerIconUseDifferentForHover})},onChangeMapMarkerIconHover:function(e){return c.setAttributes({mapMarkerIconHover:e})},onChangeMapStyle:function(e){return c.setAttributes({mapStyle:e})},onChangeMapStreetView:function(){c.setAttributes({mapStreetView:!c.attributes.mapStreetView})},onChangeMarkerId:function(e,t){return b("markerId",e,t)},onChangeMarkerAddress:function(t,o){e.setState({useServerRender:!0}),t&&b("markerAddress",t.label,o)},onChangeMarkerSource:function(t,o){e.setState({useServerRender:!0});var r=JSON.parse(c.attributes.markerView),n=JSON.parse(c.attributes.markerViewField);if("view"===t&&!r[o]){var a=h();if(a.length)if(a[0].attributes.view){var i=a[0].attributes.view;b("markerView",i.ID,o)}else a[0].attributes.viewId&&(b("markerView",a[0].attributes.viewId,o),a[0].attributes.previewId&&b("markerPreviewView",a[0].attributes.previewId,o));n[o]||Object(f.isEmpty)(M.addressFields)||b("markerViewField",Object.keys(M.addressFields)[0],o)}b("markerSource",t,o)},onChangeCurrentVisitorLocationRenderTime:function(e,t){b("currentVisitorLocationRenderTime",e,t)},onAddAnotherMarker:function(){e.setState({useServerRender:!0});var t=d(c.attributes);t.markerId.push(e.getNextMarkerId()),t.markerAddress.push(""),t.markerSource.push("address"),t.currentVisitorLocationRenderTime.push("immediate"),t.markerLat.push(""),t.markerLon.push(""),t.markerTitle.push(""),t.popupContent.push(""),t.markerUseMapIcon.push(!0),t.markerIcon.push(""),t.markerIconUseDifferentForHover.push(!1),t.markerIconHover.push(""),t.markerDynamicAddress.push({}),t.markerView.push(""),t.markerPreviewView.push(""),t.markerViewField.push(""),y(t)},onRemoveMarker:function(e){var t=d(c.attributes);p.forEach((function(o){t[o].splice(e,1)})),y(t)},onChangeLatitude:function(t,o){b("markerLat",t,o),e.setState({useServerRender:!0})},onChangeLongitude:function(e,t){return b("markerLon",e,t)},onChangeMarkerTitle:function(e,t){b("markerTitle",e.replace(/\[/g,"{{").replace(/\]/g,"}}"),t)},onChangePopupContent:function(t,o){e.setState({useServerRender:!0}),b("popupContent",t.replace(/\[/g,"{{").replace(/\]/g,"}}"),o)},onChangeMarkerUseMapIcon:function(e){var t=d(c.attributes),o=t.mapMarkerIcon,r=t.markerUseMapIcon[e];b("markerIcon",r?o:"",e),v("markerUseMapIcon",e)},onChangeMarkerIcon:function(e,t){var o=d(c.attributes).mapMarkerIcon;!e&&o&&(e="default"),b("markerIcon",e,t)},onChangeMarkerIconUseDifferentForHover:function(e){v("markerIconUseDifferentForHover",e)},onChangeMarkerIconHover:function(e,t){b("markerIconHover",e,t)},onChangeMarkerDynamicAddress:function(t,o){e.setState({useServerRender:!0});var r=d(c.attributes).markerDynamicAddress[o];(Object(f.isEmpty)(r)||null===t)&&(r={postProvider:null,source:null,field:null,customPost:null,isActive:!0}),t&&(r.postProvider=t.postProvider,r.source=t.source,r.field=t.field,r.customPost=t.customPost),b("markerDynamicAddress",r,o)},onChangeMarkerView:function(t,o){e.setState({useServerRender:!0}),b("markerView",t,o),h().some((function(e){if(e.attributes.previewId&&e.attributes.viewId&&Number(e.attributes.viewId)===Number(t))return b("markerPreviewView",e.attributes.previewId,o),!0;b("markerPreviewView","",o)}))},getViewBlocks:h,onChangeMarkerViewField:function(e,t){b("markerViewField",e,t)}}),!(!M.apiKey&&"osm"!==M.api)&&(o?React.createElement(i.a,{key:"map-render-".concat(c.clientId,"-").concat(r),block:M.blockName,attributes:l,onRenderComplete:this.handleServerRenderComplete}):React.createElement(s.a,{key:"map-render-".concat(c.clientId),block:M.blockName,attributes:this.props.attributes})),!(M.apiKey||"osm"===M.api)&&React.createElement(m.Notice,{key:"toolset-gutenberg-map-block-notice",status:"error",isDismissible:!1,actions:[{label:Object(n.__)("Enter an API key on the Toolset Settings page.","toolset-maps"),url:M.settingsLink}]},React.createElement(m.Dashicon,{icon:"warning"}),Object(n.__)(" You need an API key to use Toolset Map block.","toolset-maps")),React.createElement(u.BlockControls,{key:"controls"},React.createElement(u.BlockAlignmentToolbar,{value:c.attributes.align,controls:["wide","full"],onChange:function(e){return c.setAttributes({align:e})}}))]}}])&&v(o.prototype,r),l&&v(o,l),h}(r.Component),I=Object(l.compose)([Object(p.withSelect)((function(e){var t=e("core/editor").getCurrentPostId,o=e("core/block-editor").getBlocks,r=e(window.toolsetDynamicSourcesScriptData.dynamicSourcesStore).getPreviewPost;return{post:t(),blocks:o(),previewPost:r()}})),d.withPostPreview])(j);t.b=I}).call(this,o("./node_modules/webpack/buildin/global.js"))},"./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/index.js":function(e,t,o){"use strict";o.r(t);var r=o("@wordpress/components"),n=React.createElement(r.Icon,{className:"toolset-block-icon toolset-block-icon-maps",icon:React.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M17.3 3.3H15V1C15 0.4 14.6 0 14 0H12.7C12.1 0 11.7 0.4 11.7 1V3.3H8.30001V1C8.30001 0.4 7.90001 0 7.30001 0H6.00001C5.40001 0 5.00001 0.4 5.00001 1V3.3H2.70001C2.10001 3.3 1.70001 3.7 1.70001 4.3V19C1.70001 19.6 2.10001 20 2.70001 20H17.4C18 20 18.4 19.6 18.4 19V4.3C18.3 3.8 17.9 3.3 17.3 3.3ZM10 16.4C10 16.4 6.50001 13.5 6.50001 10.9C6.50001 8.9 8.00001 7.4 10 7.4C12 7.4 13.5 8.9 13.5 10.9C13.5 13.5 10 16.4 10 16.4ZM10 8.8C8.60001 8.8 7.40001 10.1 7.80001 11.6C8.00001 12.4 8.60001 13 9.40001 13.2C10.9 13.6 12.2 12.5 12.2 11C12.3 9.8 11.2 8.8 10 8.8Z",fill:"#ED793E"}))}),a=o("./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/edit.js"),i=(o("./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/styles/editor.scss"),wp.i18n.__),s=wp.blocks.registerBlockType,c=window.toolset_map_block_strings;s(c.blockName,{title:i("Map","toolset-maps"),description:i("Add a map and markers to the editor.","toolset-maps"),category:c.blockCategory,icon:n,keywords:["Toolset",i("map","toolset-maps"),i("shortcode","toolset-maps")],edit:a.b,save:function(){},supports:{html:!1,customClassName:!1},getEditWrapperProps:function(e){var t=e.align;if(["wide","full"].includes(t))return{"data-align":t}}})},"./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/inspector/inspector.js":function(e,t,o){"use strict";o.d(t,"a",(function(){return Ie}));var r=o("./node_modules/classnames/index.js"),n=o.n(r),a=o("react"),i=o.n(a),s=o("./node_modules/lodash.debounce/index.js"),c=o.n(s),l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};function u(e,t){function o(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var p=function(){return(p=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},d={autoActivateFirstSuggest:!1,disabled:!1,fixtures:[],getSuggestLabel:function(e){return e.description},highlightMatch:!0,ignoreEnter:!1,ignoreTab:!1,initialValue:"",maxFixtures:10,minLength:1,onKeyDown:function(){},onKeyPress:function(){},placeholder:"Search places",queryDelay:250,skipSuggest:function(){return!1},style:{},inputType:"text"},m=["autoCapitalize","autoComplete","autoCorrect","autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","height","inputMode","maxLength","name","onClick","onContextMenu","onCopy","onCut","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPaste","pattern","placeholder","readOnly","required","size","spellCheck","tabIndex","title","aria-atomic","aria-busy","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-dropeffect","aria-errormessage","aria-flowto","aria-grabbed","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription","aria-activedescendant","aria-autocomplete","aria-multiline","aria-placeholder","aria-readonly","aria-required"];function f(e){var t={};return Object.keys(e).forEach((function(o){var r=o.startsWith("data-");(m.includes(o)||r)&&(t[o]=e[o])})),t}var g=function(e){function t(t){var o=e.call(this,t)||this;return o.input=null,o.onChange=o.onChange.bind(o),o.onInputKeyDown=o.onInputKeyDown.bind(o),o}return u(t,e),t.prototype.onChange=function(){this.input&&this.props.onChange(this.input.value)},t.prototype.onInputKeyDown=function(e){switch(this.props.onKeyDown&&this.props.onKeyDown(e),e.which){case 40:e.shiftKey||(e.preventDefault(),this.props.onNext());break;case 38:e.shiftKey||(e.preventDefault(),this.props.onPrev());break;case 13:this.props.doNotSubmitOnEnter&&e.preventDefault(),this.props.ignoreEnter||this.props.onSelect();break;case 9:this.props.ignoreTab||this.props.onSelect();break;case 27:this.props.onEscape()}},t.prototype.focus=function(){this.input&&this.input.focus()},t.prototype.blur=function(){this.input&&this.input.blur()},t.prototype.render=function(){var e=this,t=f(this.props),o=n()("geosuggest__input",this.props.className),r=this.props.label&&this.props.id;return t.tabIndex||(t.tabIndex=0),Object(a.createElement)(a.Fragment,null,r&&Object(a.createElement)("label",{className:"geosuggest__label",htmlFor:this.props.id},this.props.label),Object(a.createElement)("input",p({className:o,id:"geosuggest__input"+(this.props.id?"--"+this.props.id:""),ref:function(t){return e.input=t},type:this.props.inputType},t,{value:this.props.value,style:this.props.style,onKeyDown:this.onInputKeyDown,onChange:this.onChange,onKeyPress:this.props.onKeyPress,onFocus:this.props.onFocus,onBlur:this.props.onBlur,role:"combobox","aria-expanded":!this.props.isSuggestsHidden,"aria-activedescendant":this.props.activeSuggest?this.props.activeSuggest.placeId:void 0,"aria-owns":this.props.listId})))},t.defaultProps={activeSuggest:null,autoComplete:"nope",className:"",isSuggestsHidden:!0,listId:"",inputType:"text",onBlur:function(){},onChange:function(){},onEscape:function(){},onFocus:function(){},onKeyDown:function(){},onKeyPress:function(){},onNext:function(){},onPrev:function(){},onSelect:function(){},value:""},t}(a.PureComponent),h=function(e){function t(t){var o=e.call(this,t)||this;return o.ref=null,o.onClick=o.onClick.bind(o),o}return u(t,e),t.prototype.makeBold=function(e,t){return Object(a.createElement)("b",{className:"geosuggest__item__matched-text",key:t},e)},t.prototype.formatMatchedText=function(e,t){if(!e||!t.matchedSubstrings)return t.label;var o=t.matchedSubstrings.offset,r=o+t.matchedSubstrings.length,n=this.makeBold(t.label.substring(o,r),t.label),i="",s="";return o>0&&(i=t.label.slice(0,o)),r<t.label.length&&(s=t.label.slice(r)),Object(a.createElement)("span",null,i,n,s)},t.prototype.componentDidUpdate=function(e){!e.isActive&&this.props.isActive&&this.scrollIfNeeded()},t.prototype.scrollIfNeeded=function(){var e=this.ref,t=e&&e.parentElement;if(e&&t){var o=e.offsetTop-t.offsetTop<t.scrollTop,r=e.offsetTop-t.offsetTop+e.clientHeight>t.scrollTop+t.clientHeight;(o||r)&&(t.scrollTop=e.offsetTop-t.offsetTop-t.clientHeight/2+e.clientHeight/2)}},t.prototype.onClick=function(e){e.preventDefault(),this.props.onSelect(this.props.suggest)},t.prototype.render=function(){var e,t=this,o=this.props.suggest,r=n()("geosuggest__item",this.props.className,this.props.suggestItemClassName,{"geosuggest__item--active":this.props.isActive},((e={})[this.props.activeClassName||""]=this.props.activeClassName?this.props.isActive:null,e)),i=o.label;return this.props.renderSuggestItem?i=this.props.renderSuggestItem(o,this.props.userInput):this.props.isHighlightMatch&&(i=this.formatMatchedText(this.props.userInput,o)),Object(a.createElement)("li",{className:r,ref:function(e){return t.ref=e},style:this.props.style,onMouseDown:this.props.onMouseDown,onMouseOut:this.props.onMouseOut,onClick:this.onClick,role:"option","aria-selected":this.props.isActive,id:o.placeId},i)},t}(a.PureComponent),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.isHidden=function(){return this.props.isHidden||0===this.props.suggests.length},t.prototype.componentDidUpdate=function(e){e.suggests!==this.props.suggests&&0===this.props.suggests.length&&this.props.onSuggestNoResults()},t.prototype.render=function(){var e,t=this,o=n()("geosuggest__suggests",this.props.suggestsClassName,{"geosuggest__suggests--hidden":this.isHidden()},((e={})[this.props.hiddenClassName||""]=this.props.hiddenClassName?this.isHidden():null,e));return Object(a.createElement)("ul",{className:o,style:this.props.style,role:"listbox",id:this.props.listId},this.props.suggests.map((function(e){var o=t.props.activeSuggest&&e.placeId===t.props.activeSuggest.placeId||!1;return Object(a.createElement)(h,{key:e.placeId,className:e.className||"",userInput:t.props.userInput,isHighlightMatch:t.props.isHighlightMatch,suggest:e,style:t.props.suggestItemStyle,suggestItemClassName:t.props.suggestItemClassName,isActive:o,activeClassName:t.props.suggestItemActiveClassName,onMouseDown:t.props.onSuggestMouseDown,onMouseOut:t.props.onSuggestMouseOut,onSelect:t.props.onSuggestSelect,renderSuggestItem:t.props.renderSuggestItem})})))},t}(a.PureComponent);var v=function(e){function t(t){var o=e.call(this,t)||this;return o.googleMaps=null,o.autocompleteService=null,o.placesService=null,o.sessionToken=void 0,o.geocoder=null,o.input=null,o.state={activeSuggest:null,ignoreBlur:!1,isLoading:!1,isSuggestsHidden:!0,suggests:[],userInput:t.initialValue||""},o.onInputChange=o.onInputChange.bind(o),o.onAfterInputChange=o.onAfterInputChange.bind(o),o.onInputFocus=o.onInputFocus.bind(o),o.onInputBlur=o.onInputBlur.bind(o),o.onNext=o.onNext.bind(o),o.onPrev=o.onPrev.bind(o),o.onSelect=o.onSelect.bind(o),o.onSuggestMouseDown=o.onSuggestMouseDown.bind(o),o.onSuggestMouseOut=o.onSuggestMouseOut.bind(o),o.onSuggestNoResults=o.onSuggestNoResults.bind(o),o.hideSuggests=o.hideSuggests.bind(o),o.selectSuggest=o.selectSuggest.bind(o),o.listId="geosuggest__list"+(t.id?"--"+t.id:""),t.queryDelay&&(o.onAfterInputChange=c()(o.onAfterInputChange,t.queryDelay)),o}return u(t,e),t.prototype.componentDidUpdate=function(e){e.initialValue!==this.props.initialValue&&this.setState({userInput:this.props.initialValue||""}),JSON.stringify(e.fixtures)!==JSON.stringify(this.props.fixtures)&&this.searchSuggests()},t.prototype.componentDidMount=function(){if("undefined"!=typeof window){var e=this.props.googleMaps||window.google&&window.google.maps||this.googleMaps;e?(this.googleMaps=e,this.autocompleteService=new e.places.AutocompleteService,this.placesService=new e.places.PlacesService(document.createElement("div")),this.sessionToken=new e.places.AutocompleteSessionToken,this.geocoder=new e.Geocoder):console&&console.error("Google maps API was not found in the page.")}},t.prototype.componentWillUnmount=function(){clearTimeout(this.timer)},t.prototype.onInputChange=function(e){e||this.props.onSuggestSelect&&this.props.onSuggestSelect(),this.setState({userInput:e},this.onAfterInputChange)},t.prototype.onAfterInputChange=function(){this.showSuggests(),this.props.onChange&&this.props.onChange(this.state.userInput)},t.prototype.onInputFocus=function(){this.props.onFocus&&this.props.onFocus(),this.showSuggests()},t.prototype.onInputBlur=function(){this.state.ignoreBlur||this.hideSuggests()},t.prototype.onNext=function(){this.activateSuggest("next")},t.prototype.onPrev=function(){this.activateSuggest("prev")},t.prototype.onSelect=function(){this.selectSuggest(this.state.activeSuggest)},t.prototype.onSuggestMouseDown=function(){this.setState({ignoreBlur:!0})},t.prototype.onSuggestMouseOut=function(){this.setState({ignoreBlur:!1})},t.prototype.onSuggestNoResults=function(){this.props.onSuggestNoResults&&this.props.onSuggestNoResults(this.state.userInput)},t.prototype.focus=function(){this.input&&this.input.focus()},t.prototype.blur=function(){this.input&&this.input.blur()},t.prototype.update=function(e){this.setState({userInput:e}),this.props.onChange&&this.props.onChange(e)},t.prototype.clear=function(){this.setState({userInput:""},this.hideSuggests)},t.prototype.searchSuggests=function(){var e=this;if(this.state.userInput){var t={input:this.state.userInput,sessionToken:this.sessionToken},o=this.state.userInput.length;if(this.props.minLength&&o<this.props.minLength)this.updateSuggests();else{var r=this.props,n=r.location,a=r.radius,i=r.bounds,s=r.types,c=r.country;n&&(t.location=n),a&&(t.radius=Number(this.props.radius)),i&&(t.bounds=i),s&&(t.types=s),c&&(t.componentRestrictions={country:c}),this.setState({isLoading:!0},(function(){e.autocompleteService?e.autocompleteService.getPlacePredictions(t,(function(t){e.setState({isLoading:!1}),e.updateSuggests(t||[],(function(){e.props.autoActivateFirstSuggest&&!e.state.activeSuggest&&e.activateSuggest("next")}))})):e.setState({isLoading:!1})}))}}else this.updateSuggests()},t.prototype.updateSuggests=function(e,t){var o=this;void 0===e&&(e=[]),void 0===t&&(t=function(){});var r,n=[],a=this.state.userInput,i=this.props,s=i.skipSuggest,c=i.maxFixtures,l=i.fixtures,u=new RegExp(a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"gim"),d=0;l&&l.forEach((function(e){c&&d>=c||s&&!s(e)&&e.label.match(u)&&(d++,n.push(p(p({},e),{isFixture:!0,matchedSubstrings:{length:a.length,offset:e.label.indexOf(a)},placeId:e.placeId||e.label})))})),e.forEach((function(e){s&&!s(e)&&n.push({description:e.description,isFixture:!1,label:o.props.getSuggestLabel?o.props.getSuggestLabel(e):"",matchedSubstrings:e.matched_substrings[0],placeId:e.place_id})})),r=this.updateActiveSuggest(n),this.props.onUpdateSuggests&&this.props.onUpdateSuggests(n,r),this.setState({suggests:n,activeSuggest:r},t)},t.prototype.updateActiveSuggest=function(e){void 0===e&&(e=[]);var t=this.state.activeSuggest;if(t){var o=e.filter((function(e){return t&&t.placeId===e.placeId&&t.isFixture===e.isFixture}))[0];t=o||null}return t},t.prototype.showSuggests=function(){this.searchSuggests(),this.setState({isSuggestsHidden:!1})},t.prototype.hideSuggests=function(){var e=this;this.props.onBlur&&this.props.onBlur(this.state.userInput),this.timer=window.setTimeout((function(){e.setState({activeSuggest:null,isSuggestsHidden:!0})}),100)},t.prototype.activateSuggest=function(e){if(this.state.isSuggestsHidden)this.showSuggests();else{for(var t=this.state.suggests.length-1,o="next"===e,r=null,n=0,a=0;a<=t;a++)this.state.suggests[a]===this.state.activeSuggest&&(n=o?a+1:a-1);this.state.activeSuggest||(n=o?0:t),n>=0&&n<=t&&(r=this.state.suggests[n]),this.props.onActivateSuggest&&this.props.onActivateSuggest(r),this.setState({activeSuggest:r})}},t.prototype.selectSuggest=function(e){var t=e||{isFixture:!0,label:this.state.userInput,placeId:this.state.userInput};if(!e&&this.props.autoActivateFirstSuggest&&this.state.suggests.length>0&&(t=this.state.suggests[0]),this.setState({isSuggestsHidden:!0,userInput:"object"!=typeof t.label?t.label:t.description||""}),t.location)return this.setState({ignoreBlur:!1}),void(this.props.onSuggestSelect&&this.props.onSuggestSelect(t));this.geocodeSuggest(t)},t.prototype.geocodeSuggest=function(e){var t=this;if(this.geocoder)if(e.placeId&&!e.isFixture&&this.placesService){var o={placeId:e.placeId,sessionToken:this.sessionToken};this.props.placeDetailFields&&(o.fields=this.props.placeDetailFields,o.fields.unshift("geometry")),this.placesService.getDetails(o,(function(o,r){if(r===t.googleMaps.places.PlacesServiceStatus.OK){var n=o,a=n.geometry&&n.geometry.location,i=p(p({},e),{gmaps:n,location:{lat:a.lat(),lng:a.lng()}});t.sessionToken=new google.maps.places.AutocompleteSessionToken,t.props.onSuggestSelect&&t.props.onSuggestSelect(i)}}))}else{o={address:e.label,bounds:this.props.bounds,componentRestrictions:this.props.country?{country:this.props.country}:void 0,location:this.props.location};this.geocoder.geocode(o,(function(o,r){if(r===t.googleMaps.GeocoderStatus.OK){var n=o[0],a=n.geometry&&n.geometry.location,i=p(p({},e),{gmaps:n,location:{lat:a.lat(),lng:a.lng()}});t.props.onSuggestSelect&&t.props.onSuggestSelect(i)}}))}},t.prototype.render=function(){var e=this,t=f(this.props),o=n()("geosuggest",this.props.className,{"geosuggest--loading":this.state.isLoading}),r=Object(a.createElement)(g,p({className:this.props.inputClassName,ref:function(t){return e.input=t},value:this.state.userInput,doNotSubmitOnEnter:!this.state.isSuggestsHidden,ignoreTab:this.props.ignoreTab,ignoreEnter:this.props.ignoreEnter,style:this.props.style&&this.props.style.input,onChange:this.onInputChange,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onKeyDown:this.props.onKeyDown,onKeyPress:this.props.onKeyPress,inputType:this.props.inputType,onNext:this.onNext,onPrev:this.onPrev,onSelect:this.onSelect,onEscape:this.hideSuggests,isSuggestsHidden:this.state.isSuggestsHidden,activeSuggest:this.state.activeSuggest,label:this.props.label,id:this.props.id,listId:this.listId},t)),i=Object(a.createElement)(b,{isHidden:this.state.isSuggestsHidden,style:this.props.style&&this.props.style.suggests,suggestItemStyle:this.props.style&&this.props.style.suggestItem,userInput:this.state.userInput,isHighlightMatch:Boolean(this.props.highlightMatch),suggestsClassName:this.props.suggestsClassName,suggestItemClassName:this.props.suggestItemClassName,suggests:this.state.suggests,hiddenClassName:this.props.suggestsHiddenClassName,suggestItemActiveClassName:this.props.suggestItemActiveClassName,activeSuggest:this.state.activeSuggest,onSuggestNoResults:this.onSuggestNoResults,onSuggestMouseDown:this.onSuggestMouseDown,onSuggestMouseOut:this.onSuggestMouseOut,onSuggestSelect:this.selectSuggest,renderSuggestItem:this.props.renderSuggestItem,listId:this.listId});return Object(a.createElement)("div",{className:o,id:this.props.id},Object(a.createElement)("div",{className:"geosuggest__input-wrapper"},r),Object(a.createElement)("div",{className:"geosuggest__suggests-wrapper"},i))},t.defaultProps=d,t}(a.Component),y=o("toolset/block/control");function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,r=j(e);if(t){var n=j(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return O(this,o)}}function O(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?M(e):t}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var I=wp.i18n.__,R=wp.element.Component,E=window.toolset_map_block_strings,P=function(e){if(!e||e.length<2)return Promise.resolve([]);var t={"subscription-key":window.toolset_maps_address_autocomplete_i10n.azure_api_key,"api-version":"1.0",typeahead:!0,query:e},o="https://atlas.microsoft.com/search/address/json?"+new URLSearchParams(t).toString();return window.fetch(o).then((function(e){return e.json()}),(function(){return Promise.resolve({options:[]})})).then((function(e){var t=e.results,o=_.pluck(t,"address");return _.pluck(o,"freeformAddress").map((function(e){return{value:e,label:e}}))}))},x=function(e){if(!e||e.length<2)return Promise.resolve([]);var t=new URLSearchParams({format:"json",limit:"5",q:e}),o="".concat("https://nominatim.openstreetmap.org/search","?").concat(t.toString());return window.fetch(o).then((function(e){return e.json()})).then((function(e){return e.map((function(e){return{value:e.display_name,label:e.display_name}}))})).catch((function(){return Promise.resolve([])}))},T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(a,e);var t,o,r,n=C(a);function a(){var e,t,o,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),e=n.call(this),t=M(e),r=function(){setTimeout((function(){void 0===window.google?e.waitForGoogleToLoad():e.setState({googleLoaded:!0})}),500)},(o="waitForGoogleToLoad")in t?Object.defineProperty(t,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[o]=r,e.state={googleLoaded:void 0!==window.google},e}return t=a,(o=[{key:"componentDidMount",value:function(){"google"!==E.api||this.state.googleLoaded||this.waitForGoogleToLoad()}},{key:"render",value:function(){var e=this.props,t=e.markerAddress,o=e.addressKey,r=e.onChangeMarkerAddress,n=this.state.googleLoaded,a="address-autocomplete-component-"+o,i=t[o],s=function(){return n?React.createElement(v,{id:a,onSuggestSelect:function(e){return r(e,o)},initialValue:i,placeholder:I("Type your address here","toolset-maps")}):null},c="azure"===E.api?P:x;return React.createElement("div",null,React.createElement("label",{htmlFor:a},I("Marker Address","toolset-maps")),"google"===E.api?React.createElement(s,null):React.createElement(y.AsyncSelect,{id:a,value:{value:i,label:i},defaultOptions:[{value:i,label:i}],onChange:function(e){return r(e,o)},loadOptions:c}))}}])&&w(t.prototype,o),r&&w(t,r),a}(R);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,r=B(e);if(t){var n=B(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return V(this,o)}}function V(e,t){return!t||"object"!==A(t)&&"function"!=typeof t?H(e):t}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var Z=wp.element.Component,K=wp.components.BaseControl,z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(i,e);var t,o,r,a=L(i);function i(){var e;D(this,i);for(var t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return U(H(e=a.call.apply(a,[this].concat(o))),"getOptionValueFromDataImg",(function(e){return/data\x2Dimg="([\s\S]*?)"/.exec(e)[1]})),e}return t=i,(o=[{key:"render",value:function(){var e=this,t=this.props,o=t.label,r=t.className,a=t.selected,i=t.help,s=t.instanceId,c=t.onChange,l=t.options,u="marker-radio-control-".concat(s),p=function(e){return c(e.target.value)};return!!l.length&&React.createElement(K,{label:o,id:u,help:i,className:n()(r,"marker-radio-control")},React.createElement("ul",null,l.map((function(t,o){return React.createElement("li",{key:"".concat(u,"-").concat(o),className:"marker-radio-control__option"},React.createElement("span",{className:"wpv-icon-img js-wpv-icon-img","data-img":t.value?t.value:e.getOptionValueFromDataImg(t.label),style:{backgroundImage:"url("+(t.value?t.value:e.getOptionValueFromDataImg(t.label))+")",backgroundPositionX:"50%",backgroundPositionY:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain",width:"32px",height:"46px",display:"inline-block"}}),React.createElement("br",null),React.createElement("input",{id:"".concat(u,"-").concat(o),className:"marker-radio-control__input",type:"radio",name:u,value:t.value,onChange:p,checked:t.value===a,"aria-describedby":i?"".concat(u,"__help"):void 0}))}))))}}])&&N(t.prototype,o),r&&N(t,r),i}(Z),J=o("./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/edit.js"),W=o("@wordpress/i18n"),q=o("ToolsetDynamicSources"),Q=o("toolset/utils"),G=o("@wordpress/element"),$=o("@wordpress/components");function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var o=[],r=!0,n=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(o.push(i.value),!t||o.length!==t);r=!0);}catch(e){n=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw a}}return o}(e,t)||te(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){var o;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(o=te(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==o.return||o.return()}finally{if(s)throw a}}}}function te(e,t){if(e){if("string"==typeof e)return oe(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?oe(e,t):void 0}}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function re(e,t,o,r,n,a,i){try{var s=e[a](i),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(r,n)}function ne(e){return function(){var t=this,o=arguments;return new Promise((function(r,n){var a=e.apply(t,o);function i(e){re(a,r,n,i,s,"next",e)}function s(e){re(a,r,n,i,s,"throw",e)}i(void 0)}))}}function ae(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e,t){return(ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function se(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,r=ue(e);if(t){var n=ue(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return ce(this,o)}}function ce(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?le(e):t}function le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pe(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var de=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(a,e);var t,o,r,n=se(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),pe(le(t=n.call(this,e)),"getStrPosObjects",(function(e,t){var o=t.indexOf(e),r=t.substring(0,o).split(/\r\n|\r|\n/).length-1,n=t.split(/\r\n|\r|\n/)[r].indexOf(e);return{begin:{line:r,ch:n},end:{line:r,ch:n+e.length}}})),pe(le(t),"save",(function(){t.props.save(t.implodeShortcodes(t.editor.getValue()))})),pe(le(t),"saveAndExit",(function(){t.props.removeHooks(),t.save()})),pe(le(t),"cancel",(function(){t.props.removeHooks(),t.props.cancel()})),pe(le(t),"buildShortcodeMap",function(){var e=ne(regeneratorRuntime.mark((function e(o){var r,n,a,i,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=/\[(.*?)(\s.*?)?\](?:([^\[]+)?\[\/(.*?)\])?/gm,n=o.match(r)){e.next=4;break}return e.abrupt("return");case 4:a=ee(n),e.prev=5,a.s();case 7:if((i=a.n()).done){e.next=16;break}return s=i.value,e.next=11,Q.ShortcodeRender.render(s,!1,!1,t.props.previewPostId);case 11:(c=e.sent)||(c=s),t.shortcodeMap.set(s,c);case 14:e.next=7;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),a.e(e.t0);case 21:return e.prev=21,a.f(),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[5,18,21,24]])})));return function(t){return e.apply(this,arguments)}}()),pe(le(t),"expandShortcodes",function(){var e=ne(regeneratorRuntime.mark((function e(o){var r,n,a,i,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.buildShortcodeMap(o);case 2:r=o,n=ee(t.shortcodeMap);try{for(n.s();!(a=n.n()).done;)i=X(a.value,2),s=i[0],c=i[1],r=r.replace(s,c)}catch(e){n.e(e)}finally{n.f()}t.setState({livePreview:r});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),pe(le(t),"implodeShortcodes",(function(e){var o,r=e,n=ee(t.shortcodeMap);try{for(n.s();!(o=n.n()).done;){var a=X(o.value,2),i=a[0],s=a[1];r=r.replace(s,i)}}catch(e){n.e(e)}finally{n.f()}return r})),t.textareaRef=i.a.createRef(),t.shortcodeMap=new Map,t.state={livePreview:""},t}return t=a,(o=[{key:"componentDidMount",value:function(){if(this.textareaRef.current){this.expandShortcodes(this.props.preview.original);var e=window.CodeMirror;this.editor=e.fromTextArea(this.textareaRef.current,{lineNumbers:!0,mode:this.props.mode,matchBrackets:!0,autofocus:!0})}}},{key:"componentDidUpdate",value:function(e,t){this.state.livePreview!==t.livePreview&&this.expandShortcodes(this.state.livePreview),this.editor.setValue(this.state.livePreview),this.editor.setCursor(this.editor.lineCount(),0);var o,r=ee(this.shortcodeMap);try{for(r.s();!(o=r.n()).done;){var n=X(o.value,2),a=(n[0],n[1]),i=this.getStrPosObjects(a,this.editor.getValue());this.editor.markText(i.begin,i.end,{atomic:!0,css:"background-color: #fe3"})}}catch(e){r.e(e)}finally{r.f()}}},{key:"render",value:function(){var e=this,t=this.props,o=window.Toolset,r=t.markerKey,n=t.preview,a=t.title;return i.a.createElement($.Modal,{title:a,className:"html-edit-modal",onRequestClose:this.cancel},i.a.createElement("div",{className:"tb-map-fields-and-text-toolset-button"},i.a.createElement($.Tooltip,{text:Object(W.__)("Add Field","toolset-maps")},i.a.createElement("button",{className:"components-button tb-icon-button tb-fields-and-text-toolbar-views-add-field",onClick:function(){e.props.addHooks(),e.save(),o.hooks.doAction("wpv-action-wpv-shortcodes-gui-set-gui-action","skip"),o.hooks.doAction("wpv-action-wpv-fields-alt-dialog-do-open")}},i.a.createElement("i",{className:"icon-views-logo fa fa-wpv-paragraph ont-icon-24"})))),i.a.createElement("textarea",{id:"html-edit-textarea-".concat(r),ref:this.textareaRef,defaultValue:n.original}),i.a.createElement("div",{className:"buttons"},i.a.createElement($.Button,{isDefault:!0,onClick:this.cancel},Object(W.__)("Cancel","toolset-maps")),i.a.createElement($.Button,{isPrimary:!0,onClick:this.saveAndExit},Object(W.__)("Save","toolset-maps"))))}}])&&ae(t.prototype,o),r&&ae(t,r),a}(G.Component),me=o("@wordpress/block-editor"),fe=o("lodash");function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function he(e,t){var o;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(o=function(e,t){if(!e)return;if("string"==typeof e)return be(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return be(e,t)}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==o.return||o.return()}finally{if(s)throw a}}}}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function ve(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ke(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,r=Ce(e);if(t){var n=Ce(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return we(this,o)}}function we(e,t){return!t||"object"!==ge(t)&&"function"!=typeof t?Se(e):t}function Se(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ce(e){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _e(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var Oe=window,Me=Oe.toolset_map_block_strings,je=Oe.Toolset,Ie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(i,e);var t,o,r,a=ke(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),_e(Se(t=a.call(this,e)),"addHooks",(function(){je.hooks.doAction("wpv-action-wpv-shortcodes-gui-set-gui-action","skip"),je.hooks.addAction("wpv-action-wpv-shortcodes-gui-after-do-action",t.addToolsetShortcodeToModalInput,10,2),je.hooks.doAction("toolset-action-set-shortcode-gui-action","skip"),je.hooks.addAction("toolset-action-after-do-shortcode-gui-action",t.addToolsetShortcodeToModalInput,10,2)})),_e(Se(t),"removeHooks",(function(){je.hooks.doAction("wpv-action-wpv-shortcodes-gui-set-gui-action","insert"),je.hooks.removeAction("wpv-action-wpv-shortcodes-gui-after-do-action",t.addToolsetShortcodeToModalInput),je.hooks.doAction("toolset-action-set-shortcode-gui-action","insert"),je.hooks.removeAction("toolset-action-after-do-shortcode-gui-action",t.addToolsetShortcodeToModalInput)})),_e(Se(t),"addToolsetShortcodeToModalInput",(function(e,o){if("skip"===o){var r=Se(t),n=r.props,a=r.state,i=n.attributes,s=n.onChangeMarkerTitle,c=n.onChangePopupContent,l=i.markerTitle,u=i.popupContent,p=a.markerPopupEdit,d=a.markerTitleEdit,m=a.currentlyOpenModal,f=m.type,g=m.key,h=e.hasOwnProperty("shortcode")?e.shortcode:e;"hint"===f?(s(l[g]+h,g),d[g]=!0,t.setState({markerTitleEdit:d})):(c(u[g]+h,g),p[g]=!0,t.setState({markerPopupEdit:p}))}})),_e(Se(t),"unescapeShortcodes",(function(e){return e.replace(/{{/g,"[").replace(/}}/g,"]")})),_e(Se(t),"maybeInitPreviewData",(function(e,t){return e[t]||(e[t]={original:"",preview:""}),e})),t.state={markerTitleEdit:[],markerTitlePreview:[],markerPopupEdit:[],markerPopupPreview:[],shortcodeCache:{},currentAutofocus:null,currentlyOpenModal:{type:null,key:null}},t}return t=i,(o=[{key:"render",value:function(){var e=this,t=this.props,o=t.attributes,r=t.onChangeMapId,a=t.onChangeMapWidth,i=t.onChangeMapHeight,s=t.onChangeMapZoomAutomatic,c=t.onChangeMapZoomLevelForMultipleMarkers,l=t.onChangeMapZoomLevelForSingleMarker,u=t.onChangeMapCenterLat,p=t.onChangeMapCenterLon,d=t.onChangeMapForceCenterSettingForSingleMarker,m=t.onChangeMapMarkerClustering,f=t.onChangeMapMarkerClusteringMinimalNumber,g=t.onChangeMapMarkerClusteringMinimalDistance,h=t.onChangeMapMarkerClusteringMaximalZoomLevel,b=t.onChangeMapMarkerClusteringClickZoom,v=t.onChangeMapMarkerSpiderfying,y=t.onChangeMapDraggable,k=t.onChangeMapScrollable,w=t.onChangeMapDoubleClickZoom,S=t.onChangeMapOsmTileLayer,C=t.onChangeMapType,_=t.onChangeMapTypeControl,O=t.onChangeMapZoomControls,M=t.onChangeMapStreetViewControl,j=t.onChangeMapFullScreenControl,I=t.onChangeMapBackgroundColor,R=t.onChangeMapStyle,E=t.onChangeMapLoadingText,P=t.onChangeMapMarkerIcon,x=t.onChangeMapMarkerIconUseDifferentForHover,A=t.onChangeMapMarkerIconHover,D=t.onChangeMapStreetView,N=t.onChangeMarkerId,F=t.onChangeMarkerAddress,L=t.onChangeMarkerSource,V=t.onChangeCurrentVisitorLocationRenderTime,H=t.onAddAnotherMarker,B=t.onRemoveMarker,U=t.onChangeLatitude,Z=t.onChangeLongitude,K=t.onChangeMarkerTitle,Y=t.onChangePopupContent,X=t.onChangeMarkerUseMapIcon,ee=t.onChangeMarkerIcon,te=t.onChangeMarkerIconUseDifferentForHover,oe=t.onChangeMarkerIconHover,re=t.onChangeMarkerDynamicAddress,ne=t.onChangeMarkerView,ae=t.getViewBlocks,ie=t.onChangeMarkerViewField,se=o.markerTitle,ce=o.popupContent,le=this.state,ue=le.markerTitleEdit,pe=le.markerTitlePreview,ge=le.markerPopupEdit,be=le.markerPopupPreview,ve=le.shortcodeCache,ye="google"===Me.api,ke="osm"===Me.api,we=ye||ke,Se=!o.mapDraggable&&ye,Ce=1===o.markerId.length,_e=[React.createElement($.ToggleControl,{key:"map-interaction-option-scroll",label:Object(W.__)("Scroll inside the map to zoom","toolset-maps"),checked:!!o.mapScrollable,onChange:k}),React.createElement($.ToggleControl,{key:"map-interaction-option-double-click-zoom",label:Object(W.__)("Double-click to zoom","toolset-maps"),checked:!!o.mapDoubleClickZoom,onChange:w})];Se&&(_e=[React.createElement($.Disabled,{key:"map-interaction-options-disabled"},_e)]);var Oe=[React.createElement($.ToggleControl,{key:"map-interaction-option-draggable",label:Object(W.__)("Move the map by dragging","toolset-maps"),help:Se?Object(W.__)("When this is disabled with Google API, other map interaction options don't work either.","toolset-maps"):"",checked:!!o.mapDraggable,onChange:y})];Oe.push(_e);var je=[],Ie=o.markerId.length-1,Re=!1,Ee=function(e){return Object(fe.map)(e,(function(e,t){return{label:e,value:t}}))},Pe=Ee(Me.mapStyleOptions),xe=Ee(Me.markerOptions),Te=Ee(Me.addressFields),Ae=[{value:"address",label:Object(W.__)("Address","toolset-maps")},{value:"latlon",label:Object(W.__)("GPS Coordinates","toolset-maps")},{value:"dynamic",label:Object(W.__)("Dynamic source","toolset-maps")},{value:"view",label:Object(W.__)("View block","toolset-maps")}];Me.isFrontendServerOverHttps&&Ae.push({value:"browser_geolocation",label:Object(W.__)("Location of the current visitor","toolset-maps")});var De=function(){return Object(fe.filter)(Object(fe.concat)(Object(fe.map)(ae(),(function(e){if(e.attributes.view){var t=e.attributes.view;return{label:t.post_title,value:t.ID}}if(e.attributes.viewId)return{label:wp.data.select(e.attributes.reduxStoreId).getGeneral().name,value:e.attributes.viewId}})),Ne()))},Ne=function(){var e,t=(e=Object(fe.zipObject)(o.markerSource,o.markerView)).view?parseInt(e.view):null;return t&&!Object(fe.map)(ae(),(function(e){return e.attributes.view?e.attributes.view.ID:e.attributes.viewId?e.attributes.viewId:void 0})).includes(t)?{label:Object(W.__)("- View removed from page -","toolset-maps"),value:t}:null},Fe=function(e){var t,o=null,r=he(ae());try{for(r.s();!(t=r.n()).done;){var n=t.value,a=n.attributes;Number(e)===a.viewId&&(o=wp.data.select(n.attributes.reduxStoreId).getGeneral().preview_post_id)}}catch(e){r.e(e)}finally{r.f()}return o},Le=function(t,o,r,n){var a=e.unescapeShortcodes(t[n]),i=e.maybeInitPreviewData(o,n),s=/\[(.*?)(\s.*?)?](?:([^\[]+)?\[\/(.*?)])?/gm,c=a.match(s),l=Fe(r[n]);if(i[n].original!==a||i[n].remaining)if(i[n].original=a,c){var u=i[n].preview.match(s),p="";if(""===i[n].preview?(p=c[0],i[n].preview=a):u&&(p=u[0]),p)Q.ShortcodeRender.render(p,!1,!1,l).then((function(t){i[n].preview=i[n].preview.replace(p,t),ve[p]=t,u=i[n].preview.match(s),i[n].remaining=u&&!t.startsWith("["),e.setState({state:i,shortcodeCache:ve})}));else{for(var d in i[n].preview=a,i[n].original=a,ve)i[n].preview=i[n].preview.replace(d,ve[d]);e.setState({state:i})}}else i[n].preview=a,ge[n]&&e.setState({state:i});return i[n].preview},Ve=function(e){return e in ue||(ue[e]=!1),ue[e]},He=function(e){return e in ge||(ge[e]=!1),ge[e]},Be=function(t){ue[t]=!ue[t],e.setState({markerTitleEdit:ue})},Ue=function(t){ge[t]=!ge[t],e.setState({markerPopupEdit:ge})};return o.markerId.forEach((function(t,r){var n;Re=r===Ie,je.push(React.createElement($.PanelBody,{key:"marker-panel-"+r,title:Object(W.__)("Marker "+o.markerId[r],"toolset-maps"),initialOpen:Re},React.createElement($.TextControl,{label:Object(W.__)("Marker ID","toolset-maps"),value:o.markerId[r],onChange:function(e){return N(e,r)}}),React.createElement($.RadioControl,{label:Object(W.__)("Source for the marker","toolset-maps"),selected:o.markerSource[r]?o.markerSource[r]:"address",onChange:function(e){return L(e,r)},options:Ae}),"address"===o.markerSource[r]&&React.createElement(T,{markerAddress:o.markerAddress,addressKey:r,onChangeMarkerAddress:F}),"latlon"===o.markerSource[r]&&React.createElement(G.Fragment,null,React.createElement($.TextControl,{label:Object(W.__)("Latitude","toolset-maps"),onChange:function(e){return U(e,r)},value:o.markerLat[r]}),React.createElement($.TextControl,{label:Object(W.__)("Longitude","toolset-maps"),onChange:function(e){return Z(e,r)},value:o.markerLon[r]})),"browser_geolocation"===o.markerSource[r]&&React.createElement($.RadioControl,{label:Object(W.__)("Geolocation options","toolset-maps"),selected:o.currentVisitorLocationRenderTime[r]?o.currentVisitorLocationRenderTime[r]:"immediate",onChange:function(e){return V(e,r)},options:[{value:"immediate",label:Object(W.__)("Render the map immediately and then add visitor location","toolset-maps")},{value:"wait",label:Object(W.__)("Wait until visitors share their location and only then render the map","toolset-maps")}]}),"view"===o.markerSource[r]&&!Object(fe.isEmpty)(De())&&React.createElement(G.Fragment,null,React.createElement($.SelectControl,{label:Object(W.__)("View block","toolset-maps"),value:o.markerView[r],options:De(),onChange:function(e){return ne(e,r)}}),React.createElement($.SelectControl,{label:Object(W.__)("Field","toolset-maps"),value:o.markerViewField[r],options:Te,onChange:function(e){return ie(e,r)}})),"view"===o.markerSource[r]&&Object(fe.isEmpty)(De())&&React.createElement($.Notice,{status:"warning",isDismissible:!1},React.createElement("p",null,Object(W.__)("You need to add a View block","toolset-maps"))),"dynamic"===o.markerSource[r]&&React.createElement(q.DynamicSourceUnified,{clientId:e.props.clientId,componentId:"marker-".concat(r),dynamicSourcesEligibleAttribute:{condition:"dynamic"===o.markerSource[r],postProvider:o[J.a][r].postProvider,source:o[J.a][r].source,field:o[J.a][r].field,customPost:o[J.a][r].customPost,toggleHide:!0,fieldSelectedCallback:function(e){re(e,r)},category:"text"}}),!!Ve(r)&&React.createElement(de,{mode:"htmlmixed",title:Object(W.__)("Hint content (displayed on hover)","toolset-maps"),code:se[r],save:function(e){K(e,r),Be(r)},cancel:function(){return Be(r)},addHooks:e.addHooks,removeHooks:e.removeHooks,markerKey:r,preview:pe[r],previewPostId:Fe(o.markerView[r])}),React.createElement($.BaseControl,{id:"hint-content-"+r,label:Object(W.__)("Hint content (displayed on hover)","toolset-maps")},!Ve(r)&&React.createElement($.Button,{isLink:!0,onClick:function(){ue[r]=!0,e.setState({markerTitleEdit:ue,currentAutofocus:"hint-content-"+r,currentlyOpenModal:{type:"hint",key:r}})}},Object(W.__)("Edit","toolset-maps")),React.createElement("div",{className:"tb-map-preview"},React.createElement("label",{className:"tb-map-preview-label",htmlFor:"hint-content-preview-"+r},Object(W.__)("Preview","toolset-maps")),React.createElement("div",{className:"tb-map-preview-body",id:"hint-content-preview-"+r},Le(se,pe,o.markerView,r)))),!!He(r)&&React.createElement(de,{mode:"htmlmixed",title:Object(W.__)("Pop-up content","toolset-maps"),code:ce[r],save:function(e){Y(e,r),Ue(r)},cancel:function(){return Ue(r)},addHooks:e.addHooks,removeHooks:e.removeHooks,markerKey:r,preview:be[r],previewPostId:Fe(o.markerView[r])}),React.createElement($.BaseControl,{id:"popup-content-"+r,label:Object(W.__)("Pop-up content","toolset-maps")},!He(r)&&React.createElement($.Button,{isLink:!0,onClick:function(){ge[r]=!0,e.setState({markerPopupEdit:ge,currentAutofocus:"popup-content-"+r,currentlyOpenModal:{type:"popup",key:r}})}},Object(W.__)("Edit","toolset-maps")),React.createElement("div",{className:"tb-map-preview"},React.createElement("label",{className:"tb-map-preview-label",htmlFor:"pop-up-content-preview"+r},Object(W.__)("Preview","toolset-maps")),React.createElement("div",{className:"tb-map-preview-body",id:"pop-up-content-preview"+r},Le(ce,be,o.markerView,r)))),React.createElement($.ToggleControl,{label:Object(W.__)("Use the map's icon settings","toolset-maps"),checked:!!o.markerUseMapIcon[r],onChange:function(){return X(r)}}),!o.markerUseMapIcon[r]&&React.createElement(z,{label:Object(W.__)("Marker icon","toolset-maps"),options:xe,selected:(n=o.markerIcon[r],"default"===n?"":n),onChange:function(e){return ee(e,r)},instanceId:"marker-icon"}),!o.markerUseMapIcon[r]&&React.createElement($.ToggleControl,{label:Object(W.__)("Use a different marker icon on hover","toolset-maps"),checked:!!o.markerIconUseDifferentForHover[r],onChange:function(){return te(r)}}),!o.markerUseMapIcon[r]&&!!o.markerIconUseDifferentForHover[r]&&React.createElement(z,{label:Object(W.__)("Icon when hovering this marker","toolset-maps"),options:xe,selected:o.markerIconHover[r],onChange:function(e){return oe(e,r)},instanceId:"marker-icon-hover"}),React.createElement($.Button,{isLink:!0,id:"remove-marker-"+r,className:"remove-marker-button",onClick:function(e){return B(r,e)}},Object(W.__)("Remove this marker","toolset-maps"))))})),React.createElement(me.InspectorControls,null,React.createElement("div",{className:n()("wp-block-toolset-map-inspector")},React.createElement($.PanelBody,{title:Object(W.__)("Map","toolset-maps")+" "+o.mapId},React.createElement($.TextControl,{label:Object(W.__)("Map ID","toolset-maps"),value:o.mapId,onChange:r}),!o.align&&React.createElement($.TextControl,{label:Object(W.__)("Width","toolset-maps"),value:o.mapWidth,onChange:a,help:Object(W.__)("Use percentages or units (defaults to pixels).","toolset-maps")}),React.createElement($.TextControl,{label:Object(W.__)("Height","toolset-maps"),value:o.mapHeight,onChange:i,help:Object(W.__)("Use percentages or units (defaults to pixels).","toolset-maps")}),React.createElement($.ToggleControl,{label:Object(W.__)("Adjust zoom and center to show all markers at once","toolset-maps"),checked:!!o.mapZoomAutomatic,onChange:s}),!o.mapZoomAutomatic&&React.createElement($.RangeControl,{label:Object(W.__)("Zoom level for multiple markers","toolset-maps"),value:o.mapZoomLevelForMultipleMarkers,onChange:c,min:1,max:18}),React.createElement($.RangeControl,{label:Object(W.__)("Zoom level for one marker","toolset-maps"),value:o.mapZoomLevelForSingleMarker,onChange:l,min:1,max:18}),!o.mapZoomAutomatic&&React.createElement($.TextControl,{type:"number",label:Object(W.__)("Center latitude","toolset-maps"),value:o.mapCenterLat,onChange:u}),!o.mapZoomAutomatic&&React.createElement($.TextControl,{type:"number",label:Object(W.__)("Center longitude","toolset-maps"),value:o.mapCenterLon,onChange:p}),!o.mapZoomAutomatic&&Ce&&React.createElement($.ToggleControl,{label:Object(W.__)("Force the map center setting even when only one marker is used","toolset-maps"),checked:!!o.mapForceCenterSettingForSingleMarker,onChange:d}),React.createElement($.ToggleControl,{label:Object(W.__)("Cluster markers","toolset-maps"),checked:!!o.mapMarkerClustering,onChange:m}),we&&o.mapMarkerClustering&&React.createElement($.RangeControl,{label:Object(W.__)("Minimal number of markers in a cluster","toolset-maps"),value:o.mapMarkerClusteringMinimalNumber,onChange:f,min:2,max:20}),we&&o.mapMarkerClustering&&React.createElement($.RangeControl,{label:Object(W.__)("Minimal distance, in pixels, between markers","toolset-maps"),value:o.mapMarkerClusteringMinimalDistance,onChange:g,min:10,max:100}),we&&o.mapMarkerClustering&&React.createElement($.RangeControl,{label:Object(W.__)("Maximal map zoom level that allows clustering","toolset-maps"),value:o.mapMarkerClusteringMaximalZoomLevel,onChange:h,min:1,max:18}),we&&o.mapMarkerClustering&&React.createElement($.ToggleControl,{label:Object(W.__)("Zoom the map when clicking on a cluster icon","toolset-maps"),checked:!!o.mapMarkerClusteringClickZoom,onChange:b}),!!ye&&React.createElement($.ToggleControl,{label:Object(W.__)("Spiderfy overlapping markers","toolset-maps"),help:Object(W.__)("Overlapping markers spring apart gracefully (on click).","toolset-maps"),checked:!!o.mapMarkerSpiderfying,onChange:v}),Oe,"osm"===Me.api&&React.createElement($.RadioControl,{label:Object(W.__)("Map Layers","toolset-maps"),selected:o.osmTileLayer?o.osmTileLayer:"standard",onChange:S,options:[{value:"standard",label:Object(W.__)("Standard","toolset-maps")},{value:"cyclosm",label:Object(W.__)("CyclOSM","toolset-maps")},{value:"hot",label:Object(W.__)("Humanitarian","toolset-maps")}]}),!!ye&&React.createElement($.RadioControl,{label:Object(W.__)("Map type","toolset-maps"),selected:o.mapType?o.mapType:"roadmap",onChange:C,options:[{value:"roadmap",label:Object(W.__)("Map (default view)","toolset-maps")},{value:"satellite",label:Object(W.__)("Satellite","toolset-maps")},{value:"hybrid",label:Object(W.__)("Mix of Map & Satellite","toolset-maps")},{value:"terrain",label:Object(W.__)("Terrain","toolset-maps")}]}),!!ye&&React.createElement($.ToggleControl,{label:Object(W.__)("Map type controls","toolset-maps"),checked:!!o.mapTypeControl,onChange:_}),!!ye&&React.createElement($.ToggleControl,{label:Object(W.__)("Zoom controls","toolset-maps"),checked:!!o.mapZoomControls,onChange:O}),!!ye&&React.createElement($.ToggleControl,{label:Object(W.__)("Street View control","toolset-maps"),checked:!!o.mapStreetViewControl,onChange:M}),!!ye&&React.createElement($.ToggleControl,{label:Object(W.__)("Full Screen control","toolset-maps"),checked:!!o.mapFullScreenControl,onChange:j}),!!ye&&React.createElement($.SelectControl,{label:Object(W.__)("Map style","toolset-maps"),value:o.mapStyle,options:Pe,onChange:R}),!!ye&&React.createElement($.ToggleControl,{label:Object(W.__)("Open Street View when this map loads","toolset-maps"),help:Object(W.__)("First marker added to this map will be used as location.","toolset-maps"),checked:!!o.mapStreetView,onChange:D}),React.createElement($.TextareaControl,{label:Object(W.__)("Text to show while the map is loading","toolset-maps"),value:o.mapLoadingText,onChange:E}),React.createElement($.PanelRow,null,React.createElement("label",{htmlFor:"map-background-color"},Object(W.__)("Background color","toolset-maps")),React.createElement($.ColorIndicator,{id:"map-background-color",colorValue:o.mapBackgroundColor})),React.createElement($.ColorPalette,{colors:Me.themeColors[0],value:o.mapBackgroundColor,onChange:I}),React.createElement(z,{label:Object(W.__)("Marker icon","toolset-maps"),options:xe,selected:o.mapMarkerIcon,onChange:P,instanceId:"map-marker-icon"}),React.createElement($.ToggleControl,{label:Object(W.__)("Use a different marker icon on hover","toolset-maps"),checked:!!o.mapMarkerIconUseDifferentForHover,onChange:x}),!!o.mapMarkerIconUseDifferentForHover&&React.createElement(z,{label:Object(W.__)("Marker icon on hover","toolset-maps"),options:xe,selected:o.mapMarkerIconHover,onChange:A,instanceId:"map-marker-icon-hover"})),je,React.createElement($.PanelBody,null,React.createElement($.Button,{isPrimary:!0,id:"add-another-marker",onClick:H},Object(W.__)("Add marker","toolset-maps")))))}}])&&ve(t.prototype,o),r&&ve(t,r),i}(G.Component)},"./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/render/client-side-render-map.js":function(e,t,o){"use strict";var r=o("@wordpress/server-side-render"),n=o.n(r),a=o("@wordpress/compose"),i=o("@wordpress/data"),s=o("@wordpress/element"),c=o("lodash");function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,r=g(e);if(t){var n=g(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return m(this,o)}}function m(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?f(e):t}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=window.toolset_map_block_strings,b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(i,e);var t,o,r,a=d(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this,e)).firstRender=!0,t.prevAttributes=e.attributes,t.state={needToLazyLoadAtlas:"azure"===h.api&&void 0===window.atlas},t.mapContainerRef=Object(s.createRef)(),t.debouncedUpdateMap=Object(c.debounce)(t.updateMap.bind(f(t)),500),t}return t=i,(o=[{key:"componentDidMount",value:function(){var e=this;this.state.needToLazyLoadAtlas&&(jQuery("<link/>",{rel:"stylesheet",type:"text/css",href:"https://atlas.microsoft.com/sdk/js/atlas.min.css?api-version=1.1"}).appendTo("head"),jQuery.getScript("https://atlas.microsoft.com/sdk/js/atlas.min.js?api-version=1.1").done((function(){e.setState({needToLazyLoadAtlas:!1})}))),this.firstRender=!1}},{key:"shouldComponentUpdate",value:function(e){if(Object(c.isEqual)(this.prevAttributes,e.attributes))return!1;this.debouncedUpdateMap(e.attributes),this.prevAttributes=e.attributes}},{key:"updateMap",value:function(e){var t=e.mapId;t&&window.WPViews.view_addon_maps.updateMapById(t,e)}},{key:"render",value:function(){var e=this.props.attributes.mapId;return React.createElement("div",{id:e,style:{width:"100%",height:"100%"},ref:this.mapContainerRef},this.firstRender&&React.createElement(n.a,{key:"map-render-".concat(this.props.clientId),block:this.props.block,attributes:this.props.attributes,urlQueryArgs:this.props.urlQueryArgs}))}}])&&u(t.prototype,o),r&&u(t,r),i}(s.Component),v=Object(a.compose)([Object(i.withSelect)((function(e){var t=e("core/editor").getCurrentPostId;return{urlQueryArgs:{post_id:(0,e(window.toolsetDynamicSourcesScriptData.dynamicSourcesStore).getPreviewPost)()||t()}}}))])(b);t.a=v},"./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/render/server-side-render-map.js":function(e,t,o){"use strict";var r=o("@wordpress/server-side-render"),n=o.n(r),a=o("@wordpress/compose"),i=o("@wordpress/data"),s=o("@wordpress/element"),c=o("lodash");function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,r=g(e);if(t){var n=g(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return m(this,o)}}function m(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?f(e):t}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=window.toolset_map_block_strings,b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(i,e);var t,o,r,a=d(i);function i(e,t){var o,r,n,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o=a.call(this,e,t),r=f(o),n="debouncedInitMapById",s=Object(c.debounce)(window.WPViews.view_addon_maps.initMapById,1500),n in r?Object.defineProperty(r,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[n]=s,o.hasRenderedInitially=!1,o.state={needToLazyLoadAtlas:"azure"===h.api&&void 0===window.atlas,renderCounter:0},o}return t=i,(o=[{key:"componentDidMount",value:function(){var e=this;this.state.needToLazyLoadAtlas?(jQuery("<link/>",{rel:"stylesheet",type:"text/css",href:"https://atlas.microsoft.com/sdk/js/atlas.min.css?api-version=1.1"}).appendTo("head"),jQuery.getScript("https://atlas.microsoft.com/sdk/js/atlas.min.js?api-version=1.1").done((function(){e.setState({needToLazyLoadAtlas:!1},(function(){e.debouncedInitMapById(e.props.attributes.mapId)}))}))):this.debouncedInitMapById(this.props.attributes.mapId)}},{key:"difference",value:function(e,t){var o=this;return Object(c.transform)(e,(function(e,r,n){Object(c.isEqual)(r,t[n])||(e[n]=Object(c.isObject)(r)&&Object(c.isObject)(t[n])?o.difference(r,t[n]):r)}))}},{key:"shouldComponentUpdate",value:function(e,t){var o=e.attributes,r=this.difference(o,this.props.attributes);if(r.hasOwnProperty("markerSource")){var n=JSON.parse(r.markerSource).indexOf("dynamic");if(-1!==n){var a=JSON.parse(o.markerDynamicAddress)[n];if(Object(c.isEmpty)(a))return!1}}return!Object(c.isEqual)(this.props,e)||!Object(c.isEqual)(this.state,t)}},{key:"componentDidUpdate",value:function(e){this.state.needToLazyLoadAtlas||(this.debouncedInitMapById(this.props.attributes.mapId),Object(c.isEqual)(this.props.attributes,e.attributes)||(this.hasRenderedInitially?this.props.onRenderComplete():this.hasRenderedInitially=!0))}},{key:"render",value:function(){return React.createElement(n.a,{key:"map-render-".concat(this.props.clientId,"-").concat(this.state.renderCounter),block:this.props.block,attributes:this.props.attributes,urlQueryArgs:this.props.urlQueryArgs})}}])&&u(t.prototype,o),r&&u(t,r),i}(s.Component),v=Object(a.compose)([Object(i.withSelect)((function(e){var t=e("core/editor").getCurrentPostId;return{urlQueryArgs:{post_id:(0,e(window.toolsetDynamicSourcesScriptData.dynamicSourcesStore).getPreviewPost)()||t()}}}))])(b);t.a=v},"./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/styles/editor.scss":function(e,t,o){},"./node_modules/classnames/index.js":function(e,t,o){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var o={}.hasOwnProperty;function n(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var a=typeof r;if("string"===a||"number"===a)e.push(r);else if(Array.isArray(r)&&r.length){var i=n.apply(null,r);i&&e.push(i)}else if("object"===a)for(var s in r)o.call(r,s)&&r[s]&&e.push(s)}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):void 0===(r=function(){return n}.apply(t,[]))||(e.exports=r)}()},"./node_modules/lodash.debounce/index.js":function(e,t,o){(function(t){var o=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,a=/^0o[0-7]+$/i,i=parseInt,s="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,l=s||c||Function("return this")(),u=Object.prototype.toString,p=Math.max,d=Math.min,m=function(){return l.Date.now()};function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(f(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=f(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var s=n.test(e);return s||a.test(e)?i(e.slice(2),s?2:8):r.test(e)?NaN:+e}e.exports=function(e,t,o){var r,n,a,i,s,c,l=0,u=!1,h=!1,b=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var o=r,a=n;return r=n=void 0,l=t,i=e.apply(a,o)}function y(e){return l=e,s=setTimeout(w,t),u?v(e):i}function k(e){var o=e-c;return void 0===c||o>=t||o<0||h&&e-l>=a}function w(){var e=m();if(k(e))return S(e);s=setTimeout(w,function(e){var o=t-(e-c);return h?d(o,a-(e-l)):o}(e))}function S(e){return s=void 0,b&&r?v(e):(r=n=void 0,i)}function C(){var e=m(),o=k(e);if(r=arguments,n=this,c=e,o){if(void 0===s)return y(c);if(h)return s=setTimeout(w,t),v(c)}return void 0===s&&(s=setTimeout(w,t)),i}return t=g(t)||0,f(o)&&(u=!!o.leading,a=(h="maxWait"in o)?p(g(o.maxWait)||0,t):a,b="trailing"in o?!!o.trailing:b),C.cancel=function(){void 0!==s&&clearTimeout(s),l=0,r=c=n=s=void 0},C.flush=function(){return void 0===s?i:S(m())},C}}).call(this,o("./node_modules/webpack/buildin/global.js"))},"./node_modules/webpack/buildin/global.js":function(e,t){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(e){"object"==typeof window&&(o=window)}e.exports=o},"@wordpress/block-editor":function(e,t){e.exports=window.wp.blockEditor},"@wordpress/components":function(e,t){e.exports=window.wp.components},"@wordpress/compose":function(e,t){e.exports=window.wp.compose},"@wordpress/data":function(e,t){e.exports=window.wp.data},"@wordpress/element":function(e,t){e.exports=window.wp.element},"@wordpress/hooks":function(e,t){e.exports=window.wp.hooks},"@wordpress/i18n":function(e,t){e.exports=window.wp.i18n},"@wordpress/server-side-render":function(e,t){e.exports=window.wp.serverSideRender},ToolsetDynamicSources:function(e,t){e.exports=ToolsetDynamicSources},lodash:function(e,t){e.exports=lodash},react:function(e,t){e.exports=React},"toolset/block/control":function(e,t){e.exports=window.toolsetCommonEs.block.control},"toolset/utils":function(e,t){e.exports=window.toolsetCommonEs.utils}});